<p align="center">
  <h3 align="center">CVE-2020-28043</h3>
  <p align="center">Server Side Request Forgery (SSRF) on MISP</p>
</p>

---

### Summary

MISP is an “open source threat intelligence platform. The project develops utilities and documentation for more effective threat intelligence, by sharing indicators of compromise.” Many companies around the world run local instances, so there are countless benefits of doing this. Through CVE-2020-28043 a malicious user authenticated on MISP is able to execute a Server Side Request Forgery (SSRF) attack and gain access to an organization’s internal services and applications.

---

### Mitigation

Upgrade your MISP application to last version available. In the MISP team’s own words: “The patch basically turns off the ability to issue requests to any server but the one behind the baseurl setting of MISP. We can now also set an alternate baseurl specifically for the REST client (so that MISPs behind reverse proxies/port forwarding can still query themselves). This protective measure can be disabled on demand by administrators, would they wish to return to the old behaviour.”

You can see the fix here: [https://github.com/MISP/MISP/commit/6e81c8ee8ad19576c055b5c4773f914b918f32be](https://github.com/MISP/MISP/commit/6e81c8ee8ad19576c055b5c4773f914b918f32be)

---

### References

1. https://www.misp-project.org/security/
2. https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28043
3. https://cve.circl.lu/cve/CVE-2020-28043
4. https://github.com/MISP/MISP/commit/6e81c8ee8ad19576c055b5c4773f914b918f32be
5. https://portswigger.net/web-security/ssrf
6. https://www.owasp.org/index.php/Server_Side_Request_Forgery
7. https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html