<p align="center">
  <h3 align="center">CVE-2019-15032</h3>
  <p align="center">Username Leak via Improper Error Handling on Pydio Community</p>
</p>

---

### Summary 

The Pydio[1] is a “modern file management platform built according to your business needs and regulations” and with the CVE-2019-15002[2] an attacker can use one of its main features to send a specific payload to force internal errors that consequently leaks user names from the application.

---

### Description

Pydio’s main functionality is file upload and sharing. One way to upload is through the “Remote Server” feature, where Pydio makes a request to a remote server on the Internet and downloads the file.

The problem here is that Pydio does not handle filters properly on the input of this data, allowing a malicious user to enter a URL to an internal address (see also CVE-2019-15033), such as: http://localhost

![Pydio Upload File Form](https://heitorgouvea.me/images/publications/pydio-vulnerabilities/pydio-upload-file-form.png)

And Pydio, in an unsuccessful attempt to make such a request, eventually needs to provide a response to the user. However this response is an improper error handling[3], resulting in the server’s internal folder path leaking and even stating the username who created this folder:

![Pydio Error Handling](https://heitorgouvea.me/images/publications/pydio-vulnerabilities/pydio-error-handling.png)

-

For a better understanding, we can analyze the request below:

![Pydio Error Handling Request](https://heitorgouvea.me/images/publications/pydio-vulnerabilities/pydio-error-handling-request.png)

---

### Impact

This vulnerability could serve as a helper for other vulnerabilities and thus is become even more critical; An example of this is brute-force attacks in an attempt to crack the password of leaked usernames by exploiting this vulnerability.

This vulnerability could be exploited without authentication because another feature of Pydio is the creation and making of folders available for third parties to upload and download files.

---

### Mitigation

Upgrade your Pydio application to last version available.

---

### Conclusion

An attacker, with authorized access to Pydio, can use this vulnerability to discover more information about the application, operating system and other information about the Stack structure used by the company. Thus, aligning this vulnerability with others, such as [CVE-2019-15033](CVE-2019-15033.md) to cause impacts that may become relevant.

---

### References

1. https://pydio.com/
2. https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15032
3. https://www.owasp.org/index.php/Improper_Error_Handling
4. https://sourceforge.net/projects/ajaxplorer/files/pydio-vulnerabilities/stable-channel/